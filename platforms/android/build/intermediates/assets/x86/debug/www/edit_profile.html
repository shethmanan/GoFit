<!DOCTYPE html>
<html>

<head>

  <head>
    <link rel="stylesheet" href="css/materialize.css" media="screen,projection" />
    <title>CalorieCalculator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/navbar.css">
    <link rel="stylesheet" type="text/css" href="css/my-icons-collection/font/flaticon.css">
    <link rel="stylesheet" href="css/input-field-style.css" media="screen" title="no title" charset="utf-8">
    <style>
      .input-form {
        position: absolute;
        top: 50%;
      }

      .chart {
        position: absolute;
        bottom: 15px;
        right: 24px;
      }

      .my-profile-pic {
        width: 200px;
        height: 200px;
      }

      .edit-icon {
        position: relative;
        bottom: 64px;
        right: 20px;
      }

      .btn-edit {
        border-radius: 0px;
        background-color: hsla(0, 100%, 50%, 0);
        box-shadow: none;
        left: 20px;
        bottom: -5px;
      }

      .btn-edit:hover {
        background-color: hsla(0, 100%, 50%, 0);
        box-shadow: none;
      }
      .flaticon-letter:before {
         margin-left: 0px;

       }
	   .flaticon-technology:before{
		margin-left: 0px;
		font-size: 25px;
	   }

      #profile-photo {
        height: 200px;
        width: 200px;
      }
	  #nav-btn{
		padding-left: 0px;
		}
    </style>
  </head>

  <body>
    <header></header>
    <!-- side nav -->
    <div class="side-section">
    <ul class="side-nav fixed blue lighten-3" style="left:0px">
      <li class="logo" style="background-color:transparent;"><a href="edit_profile.html"><img class="profile-pic circle" id="dp"></a></li>
      <li class="blue lighten-3"><a href="navbar.html" class="waves-effect waves-lighten" style="color:#1976d2;">Dash Board</a></li>
      <li class="blue lighten-3"><a href="remider.html" class="waves-effect waves-lighten" style="color:#1976d2;">Set Reminders</a></li>
      <li class="blue lighten-3"><a href="updated_walk.html" class="waves-effect waves-lighten" style="color:#1976d2;">Exercise</a></li>
      <ul class="collapsible collapsible-accordion">
        <li class="blue lighten-3">
          <a class="collapsible-header" class="waves-effect waves-lighten" style="color:#1976d2;">Calculators</a>
          <div class="collapsible-body">
            <ul>
              <li class="blue lighten-3">
                <a href="BMICal.html" class="waves-effect waves-lighten" style="color:#1976d2;">BMI Calculator</a>
              </li>
              <li class="blue lighten-3">
                <a href="calorieCalculator.html" class="waves-effect waves-lighten" style="color:#1976d2;">Calorie Calculator</a>
              </li>
            </ul>
          </div>
        </li>
      </ul>

      <li class="blue lighten-3"><a href="feedback.html" class="waves-effect waves-lighten" style="color:#1976d2;">Feedback</a></li>
    </ul>
  </div>
    <main>
      <!-- side nav btn -->
      <div class="row blue darken-2 no-margin">
        <a class="waves-effect waves-lighten btn-flat large" id="nav-btn">
          <i class="large flaticon-interface" style="color:white;font-size: xx-large;padding-left:0px;"></i>
        </a>
      </div>
      <!-- side nav btn ends -->
      <!-- side nav -->
      <section>
        <div class="row">
          <div class="col s8 offset-s3 no-padding">
            <div class="my-profile-pic card">
              <div class="card-image">
                <div id="myImage">
                  <img id="profile-photo">
                </div>
                <div class="row edit-icon">
                  <div class="col s4 offset-s8">
                    <a class="btn-floating btn-large waves-effect waves-light btn-edit" data-activates="dropdown1">
                      <i class="flaticon-draw"></i>
                    </a>
                    <!-- Dropdown Structure -->
                    <ul id='dropdown1' class='dropdown-content'>
                      <li><a href="#!" onClick="accessCamera()">Take a Photo</a></li>
                      <li><a href="#!" onClick="accessGallery()">Open your gallery</a></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <div class="input-form">
        <form id="personal-info">
          <div class="row no-margin no-padding">
            <div class="input-field col s12 no-margin">
              <input id="name" type="text" class="validate" name="name">
              <label for="name">Name</label>
            </div>
          </div>
          <div class="row no-margin no-padding">
            <div class="input-field col s4 no-margin">
              <input type="number" name="age" id="age" class="validate">
              <label for="age">Age</label>
            </div>
            <div class="input-field col s4 no-margin">
              <input placeholder="kg" id="weight" type="number" class="validate" name="weight">
              <label for="weight">Weight</label>
            </div>
            <div class="input-field col s4 no-margin">
              <input type="number" placeholder="cms" name="height" class="validate" id="height">
              <label for="height">Height</label>
            </div>
          </div>
          <div class="row no-margin no-padding">
            <div class="input-field col s12">
              <select name="gender" id="gender">
                <option data-icon="img/male.ico" class="left circle" value="Male">Male</option>
                <option data-icon="img/female.ico" class="left circle" value="Female">Female</option>
              </select>
              <label>Gender</label>
            </div>
          </div>
          <div class="row no-margin no-padding">
            <div class="col 4 offset-s4 no-padding">
              <a class="waves-effect waves-light blue accent-2 btn white-text" id="submitbtn" href="#"><i class="flaticon-letter right white-text"></i>Submit</a>
            </div>
          </div>
        </form>
      </div>
      <a class="btn-floating btn-large waves-effect waves-light red chart" href="profile_graph.html"><i class=" flaticon-technology"></i></a>
    </main>
    <!-- scripts -->
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/materialize.js"></script>
    <script type="text/javascript" src="js/navbar-transition.js"></script>
    <!-- <script type="text/javascript" src="cordova.js"></script> -->
    <script type="text/javascript">
      $(document).ready(function() {
        var personaldetails = localStorage.getItem("user");
      var details = JSON.parse(personaldetails);
      var imgdp=document.getElementById('dp');
      imgdp.src=details.img;
        $('.btn-edit').dropdown({
          inDuration: 300,
          outDuration: 225,
          constrain_width: false, // Does not change width of dropdown to that of the activator
          hover: false, // Activate on hover
          gutter: 0, // Spacing from edge
          belowOrigin: false, // Displays dropdown below the button
          alignment: 'left' // Displays dropdown with edge aligned to the left of button
        });
        $('select').material_select();
        var personaldetails = localStorage.getItem("user");
        var details = JSON.parse(personaldetails);
        var imgdp=document.getElementById('dp');
        imgdp.src=details.img
        var img = document.getElementById('profile-photo');
        img.src = details.img;
        $("#name").val(details.name);
        $("#age").val(details.age);
        $("#weight").val(details.weight);
        $("#height").val(details.height);
        $("#submitbtn").click(function() {
          localStorage.removeItem("user");
          var details = $('#personal-info').serializeArray();
          if (!checkInfo(details)) {
            Materialize.toast('Please fill in all your details', 4000)
            return false;
          }
          var data = getdata(details);
          localStorage.setItem("user", data);
          Materialize.toast('Your details have been modified', 4000)
        });
      });

      function checkInfo(details) {
        for (var i = 0; i < 5; i++) {
          if (details[i].value == 0) return false;
        }
        return true;
      }

      function getdata(details) {
        var data = "{";
        for (var i = 0; i < 5; i++) {
          data = data + '"' + details[i].name + '":"' + details[i].value + '",';
        }
        var imgdp = document.getElementById('profile-photo');
        data = data + '"img":"' + $("#profile-photo").attr('src') + '"}';
        return data;
      }
      String.prototype.replaceAt = function(index, character) {
        return this.substr(0, index) + character + this.substr(index + character.length);
      }

      function accessGallery() {
        var options = {
          destinationType: Camera.DestinationType.DATA_URL,
          sourceType: Camera.PictureSourceType.SAVEDPHOTOALBUM,
          targetHeight: 350,
          targetWidth: 300
        }
        navigator.camera.getPicture(onSuccess, onFail, options);
      }

      function accessCamera() {
        var options = {
          destinationType: Camera.DestinationType.DATA_URL,
          sourceType: Camera.PictureSourceType.CAMERA,
          saveToPhotoAlbum: true,
          targetHeight: 350,
          targetWidth: 300
        }
        navigator.camera.getPicture(onSuccess, onFail, options);
      }

      function onSuccess(imageData) {
        var image = document.getElementById('profile-photo');
        image.src = "data:image/jpeg;base64," + imageData;
        // alert("pic changes");
      }

      function onFail(message) {
        alert('Failed because: ' + message);
      }
    </script>
  </body>

</html>
