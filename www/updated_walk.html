<html>

<head>
	<link type="text/css" rel="stylesheet" href="css/materialize.css" media="screen,projection" />
	<link rel="stylesheet" type="text/css" href="css/navbar.css" />
	<link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" href="css/updated_walk.css" />
	<link rel="stylesheet" type="text/css" href="css/my-icons-collection/font/flaticon.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<style>
		.flaticon-cross-1:before {
			margin-left: 0px;
		}

		.flaticon-people-1:before {
			margin-left: 0px;
			font-size: 25px;
		}

		.flaticon-clock-4:before {
			margin-left: 5px;
			font-size: 25px;
		}

		.flaticon-sports-2:before {
			margin-left: 5px;
		}

		.flaticon-transport:before {
			margin-left: 4px;
		}
		#nav-btn{
			padding-left: 0px;
		}

	</style>
</head>

<body>
	<header>
	</header>
	<!-- side nav -->
	<div class="side-section">
    <ul class="side-nav fixed blue lighten-3" style="left:0px">
      <li class="logo" style="background-color:transparent;"><a href="edit_profile.html"><img class="profile-pic circle" id="dp"></a></li>
      <li class="blue lighten-3"><a href="navbar.html" class="waves-effect waves-lighten" style="color:#1976d2;">Dash Board</a></li>
      <li class="blue lighten-3"><a href="remider.html" class="waves-effect waves-lighten" style="color:#1976d2;">Set Reminders</a></li>
      <li class="blue lighten-3"><a href="updated_walk.html" class="waves-effect waves-lighten" style="color:#1976d2;">Exercise</a></li>
      <ul class="collapsible collapsible-accordion">
        <li class="blue lighten-3">
          <a class="collapsible-header" class="waves-effect waves-lighten" style="color:#1976d2;">Calculators</a>
          <div class="collapsible-body">
            <ul>
              <li class="blue lighten-3">
                <a href="BMICal.html" class="waves-effect waves-lighten" style="color:#1976d2;">BMI Calculator</a>
              </li>
              <li class="blue lighten-3">
                <a href="calorieCalculator.html" class="waves-effect waves-lighten" style="color:#1976d2;">Calorie Calculator</a>
              </li>
            </ul>
          </div>
        </li>
      </ul>

      <li class="blue lighten-3"><a href="feedback.html" class="waves-effect waves-lighten" style="color:#1976d2;">Feedback</a></li>
    </ul>
  </div>
	<main>
		<!-- side nav btn -->
		<div class="row blue darken-2 no-margin">
			<a class="waves-effect waves-lighten btn-flat large" id="nav-btn">
				<i class="large flaticon-interface" style="color:white;font-size: xx-large;padding-left:0px;"></i>
			</a>
		</div>
		<!-- side nav btn ends -->
		<!-- side nav -->
		<div class="row">
			<div class="col s12 no-padding">
				<div class="card blue no-padding darken-1 white-text step" style="margin-top:0;position:relative;">
					<div class="fixed-action-btn horizontal click-to-toggle div_fab">
						<a class="btn-floating btn-large orange darken-2">
							<i class="large flaticon-cross-1"></i>
						</a>
						<ul>
							<li><a class="btn-floating green f_btn1" href="updated_cycle.html"><i style="font-size:0px;" class="flaticon-transport"></i></a></li>
							<li><a class="btn-floating teal f_btn2" href="updated_run.html"><i class="flaticon-sports-2"></i></a></li>
							<li><a class="btn-floating red f_btn3"><i class="flaticon-people-1"></i></a></li>
						</ul>
					</div>
					<div class="gap"></div>
					<div class="gap"></div>
					<center>
						<div class="preloader-wrapper big active">
							<div style="opacity:0;" class="spinner-layer spinner-red-only" id="preload">
								<div class="circle-clipper left">
									<div class="circle"></div>
								</div>
								<div class="gap-patch">
									<div class="circle"></div>
								</div>
								<div class="circle-clipper right">
									<div class="circle"></div>
								</div>
							</div>
						</div>
						<i style="activity_status;left: 172px;top: 70px;" class="flaticon-people-1 activity_status"></i>
					</center>
				</div>
				<!--For the rounded image or animation which will show the steps-->
			</div>
		</div>
		<div class="gap"></div>
		<div class="row">
			<div class="col s6">
				<div class="row center-align">
					<i class="flaticon-clock-4 small logo_color"></i>
				</div>
				<div class="row center-align">
					<div class="col s6">
						<span class="blue-text"><div class="dynamic" id="time-min" data-val="00">00</div>mins</span>
					</div>
					<div class="col s6">
						<span class="blue-text"><div class="dynamic" id="time-sec" data-val="00">00</div>secs</span>
					</div>
				</div>
			</div>
			<div class="col s6 center-align">
				<i class="flaticon-sports-2 logo_color"></i>
				<div class="blue-text">&nbsp&nbsp
					<div class="dynamic" id="now_active_walk">00</div>steps</div>
			</div>
		</div>
		<br>
		<div class="row">
			<div class="col s12">
				<a class="btn waves-effect waves-light blue darken-4 full-width" id="start">Start Walking</a>
			</div>
		</div>
	</main>
	<script type="text/javascript" src="js/jquery.js"></script>
	<script type="text/javascript" src="js/materialize.js"></script>
	<script type="text/javascript" src="js/navbar-transition.js"></script>
 <script type="text/javascript" src="cordova.js"></script>
</body>
<script type="text/javascript">
// var clock_min;
// var clock_sec;
// var activity_id = 0;
// var activity_status = true;
// var startingOffset = 0;
// var steps;
// var totalSteps;
// var db = openDatabase('GoFit', '1.0', 'Test DB', 2 * 1024 * 1024);
// 	$(document).ready(function(data) {
// 		$("#start").click(function(data) {
// 			if (!$(this).hasClass("stop")) {
// 				console.log("inside if");
// 				start_walk_counter1();
// 				clock_min = setInterval(timer_min, 1000 * 60);
// 				clock_sec = setInterval(timer_sec, 1000);
// 				$(this).html("Stop Walking");
// 				$("#preload").css('opacity',1);
// 			} else {
// 				$("#preload").css('opacity',0);
// 				$(this).html("Start Walking");
// 				clearInterval(clock_sec);
// 				clearInterval(clock_min);
// 				stop_walk_counter();
// 			}
// 			$(this).toggleClass("stop");
// 		});
// 	});
// 	var timer_min = function() {
// 		var time = $("#time-min").attr("data-val");
// 		console.log(time++);
// 		$("#time-min").html(time);
// 		$("#time-min").attr("data-val", time);
// 	}
// 	var timer_sec = function() {
// 		var time = $("#time-sec").attr("data-val");
// 		if (time == 60) {
// 			time = -1;
// 		}
// 		console.log(time++);
// 		$("#time-sec").html(time);
// 		$("#time-sec").attr("data-val", time);
// 	}

// 	function start_walk_counter1() {
// 		activity_id = setInterval("start_walk_counter()", 1000);
// 	}

// 	function start_walk_counter() {

// 		console.log("run-called");
// 		// stepcounter.deviceCanCountSteps(success(), failure());
// 		stepcounter.start(startingOffset, success_now_active_walk, failure);
// 		stepcounter.getStepCount(success_now_active_walk, failure);
// 		// stepcounter.deviceCanCountSteps(success, failure);

// 		// use this if u want number of steps walked till now:    stepcounter.getTodayStepCount(success_today_active_run, failure);
// 		if (!activity_status) {
// 			console.log("activity cleared");
// 			clearInterval(activity_id);
// 			activity_status = true;
// 		}
// 	}
// 	var success_now_active_walk = function(message) {
// 		// console.log(message);
// 		message = parseInt(message);
// 		if (message % 2 == 1) {
// 			message = message - 1;
// 			message = message / 2;
// 		} else {
// 			message = message / 2;
// 		}
// 		$("#now_active_walk").html(message);
// 	}

// 	function stop_walk_counter() {
// 		console.log("stop-run-counter");
// 		activity_status = false;
// 		// stepcounter.getTodayStepCount(success_today_active_walk, failure);
// 		var date = new DATE();
// 		var day = date.getDay();
// 		var month = date.getMonth();
// 		var year = date.getFullYear();
// 		var min = $("#time-min").attr("data-val");
// 		var sec = $("#time-sec").attr("data-val");
// 		db.transaction(function(tx){
// 			tx.executeSql("CREATE TABLE IF NOT EXISTS `updated_walk` (id integer primary key autoincrement,steps,total_steps,min,secs,day,month,year)");
// 			tx.executeSql("INSERT INTO `updated_walk` (steps,total_steps,min,secs,day,month,year) values (?,?,?,?,?,?,?)", [steps,totalSteps, min, sec, day, month, year]);
// 		});
// 		stepcounter.stop(success, failure);
// 		console.log("stopped");
// 	}
// 	var failure = function() {
// 		console.log("Error calling CordovaStepCounter Plugin");
// 	}
// 	var success_today_active_walk = function(message) {
// 			// alert(message);
// 			totalSteps = message;
// 			// $("#today_active_run").html(message);
// 	}
var clock_min;
		var clock_sec;
		var activity_id = 0;
		var activity_status = true;
		var startingOffset = 0;
		var steps;
		var totalSteps;
		var db = openDatabase('GoFit', '1.0', 'Test DB', 2 * 1024 * 1024);
		$(document).ready(function(data) {
			var personaldetails = localStorage.getItem("user");
      var details = JSON.parse(personaldetails);
      var imgdp=document.getElementById('dp');
      imgdp.src=details.img;
			$("#start").click(function(data) {

				if (!$(this).hasClass("stop")) {
					clock_min = setInterval(timer_min, 1000 * 60);
					clock_sec = setInterval(timer_sec, 1000);
					start_run_counter();
					$(this).html("Stop Walking");
					$("#preload").css('opacity',1);
				} else {
					$(this).html("Start Walking");
					$("#preload").css('opacity',0);
					clearInterval(clock_sec);
					clearInterval(clock_min);
					stop_run_counter();
				}
				$(this).toggleClass("stop");
			});
		});
		var timer_min = function() {
			var time = $("#time-min").attr("data-val");
			console.log(time++);
			$("#time-min").html(time);
			$("#time-min").attr("data-val", time);
		}
		var timer_sec = function() {
			var time = $("#time-sec").attr("data-val");
			if (time == 60) {
				time = -1;
			}
			console.log(time++);
			$("#time-sec").html(time);
			$("#time-sec").attr("data-val", time);
		}

		function start_run_counter() {
			activity_id = setInterval("start_run_counter1()", 1000);
		}

		function start_run_counter1() {
			console.log("inside-run-counter-called");
			// stepcounter.deviceCanCountSteps(success(), failure());
			stepcounter.start(startingOffset, success_now_active_run, failure);
			stepcounter.getStepCount(success_now_active_run, failure);
			// stepcounter.deviceCanCountSteps(success, failure);

			// use this if u want number of steps walked till now:    stepcounter.getTodayStepCount(success_today_active_run, failure);
			if (!activity_status) {
				// alert("activity cleared");
				clearInterval(activity_id);
				activity_status = true;
			}
		}
		var success_now_active_run = function(message) {
			message = parseInt(message);
		if (message % 2 == 1) {
			message = message - 1;
			message = message / 2;
		} else {
			message = message / 2;
		}
		steps = message;
		$("#now_active_walk").html(message);
		}

		function stop_run_counter() {
			console.log("stop-run-counter");
			activity_status = false;
			stepcounter.getTodayStepCount(success_today_active_run, failure);
			var date = new Date();
			var day = date.getDay();
			var month = date.getMonth();
			var year = date.getFullYear();
			var min = $("#time-min").attr("data-val");
			var sec = $("#time-sec").attr("data-val");
			db.transaction(function(tx){
				tx.executeSql("CREATE TABLE IF NOT EXISTS `updated_walk` (id integer primary key autoincrement,steps,total_steps,min,secs,day,month,year)");
				tx.executeSql("INSERT INTO `updated_walk` (steps,total_steps,min,secs,day,month,year) values (?,?,?,?,?,?,?)", [steps,totalSteps, min, sec, day, month, year]);
			});
			stepcounter.stop(success, failure);
			console.log("stopped");
		}
		var failure = function() {
			console.log("Failure");
			alert("Error calling CordovaStepCounter Plugin");
		}
		var success_today_active_run = function(message) {
				// alert(message);
				totalSteps = message;
				$("#today_active_run").html(message);
		}
		var success = function(message) {
                console.log("success");
            }
</script>
<html>


